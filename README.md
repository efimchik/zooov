# Start-gulp

## Особенности
* сборка gulp 4
* возможность использования синтаксиса html или pug(jade)
* каждая задача расположена в отдельном файле
* используются препроцессоры:
    * [Pug](https://pugjs.org/) для разметки
    * [Stylus](https://stylus-lang.com/docs/) для стилей
    * [Babel](https://babeljs.io/) для поддержки ES6
* обновление папки build при каждом запуске
* автоматический запуск браузера при старте проекта и перезагрузка страницы при каждом изменении файлов в проекте
* возможность неограниченной вложенности файлов
* динамическая конвертация и подключение webp изображений
* конвертация шрифтов из форматов ```TTF``` и ```OTF``` в форматы ```WOFF``` и ```WOFF2```
* динамическое подключение шрифтов
* валидация html

## Команды для запуска проекта
* ```npm start``` - запуск проекта в режиме разработки с использованием препроцессоров pug [Pug](https://pugjs.org/) и [Stylus](https://stylus-lang.com/docs/). Без зжатия изображений, автоматическим открытием в браузере, авто перезагрузкой при изменении содержимого файлов и папок, проверка html на валидность, добавление ```sourcemap``` для stylus файлов.
* ```npm run build``` - сборка проекта с использованием препроцессоров pug [Pug](https://pugjs.org/) и [Stylus](https://stylus-lang.com/docs/), для передачи заказчику с возможностью внесения изменений. Сжатие изображений, форматирование кода в итоговых html и css файлах, без запуска проекта в браузере, отключена валидация и ```sourcemap```.
* ```npm run prod``` - сборка проекта с использованием препроцессоров pug [Pug](https://pugjs.org/) и [Stylus](https://stylus-lang.com/docs/), для передачи заказчику для последующей публикации на хостинг или интеграции в ```CMS```. Сжатие изображений, минификация итоговых html и css файлов, без запуска проекта в браузере, отключена валидация и ```sourcemap```.



* ```npm run html``` - запуск проекта в режиме разработки с использованием препроцессора [Stylus](https://stylus-lang.com/docs/) и html синтаксиса. Без зжатия изображений, автоматическим открытием в браузере, авто перезагрузкой при изменении содержимого файлов и папок, проверка html на валидность, добавление ```sourcemap``` для stylus файлов.
* ```npm run htmlbuild``` - сборка проекта с использованием препроцессора [Stylus](https://stylus-lang.com/docs/) и html синтаксиса, для передачи заказчику с возможностью внесения изменений. Сжатие изображений, форматирование кода в итоговых html и css файлах, без запуска проекта в браузере, отключена валидация и ```sourcemap```.
* ```npm run htmlprod``` - сборка проекта с использованием препроцессора [Stylus](https://stylus-lang.com/docs/) и html синтаксиса, для передачи заказчику для последующей публикации на хостинг или интеграции в ```CMS```. Сжатие изображений, минификация итоговых html и css файлов, без запуска проекта в браузере, отключена валидация и ```sourcemap```.



* ```npm run fconvert``` - запуск проекта в режиме конвертации шрифтов. Конвертирует шрифты формата otf и ttf в форматы woff и woff2, подключает шрифты к скомпилированному css файлу.


## Файловая структура

```
start-gulp
├── src
│   ├── fonts
│   ├── img
│   ├── includes
│   │   ├── core
│   │   │   ├── css
│   │   │   │   ├── fonts.styl
│   │   │   │   └── reset.styl
│   │   │   └── js
│   │   │       └── initWebpClass.js
│   │   │
│   │   ├── mixins
│   │   │   └── core
│   │   │       └── mix__fonts-include
│   │   │           └── mix__fonts-include.styl
│   │   │
│   │   ├── modules
│   │   └── templates
│   │       └── landing
│   │           ├── landing.pug
│   │           └── meta.pug
│   ├── js
│   │   └── main.js
│   │
│   ├── json
│   │   └── сonfig.json
│   │
│   ├── libs
│   │   ├── css
│   │   └── js
│   │
│   └── pages
│       ├── index.pug
│       └── main.styl
│
├── tasks
│   ├── clean.js
│   ├── copyFont.js
│   ├── csscopy.js
│   ├── fonts.js
│   ├── fontStyle.js
│   ├── html.js
│   ├── imgcompress.js
│   ├── imgcopy.js
│   ├── jscopy.js
│   ├── otf2ttf.js
│   ├── pug2html.js
│   ├── renamePath.js
│   ├── script.js
│   ├── server.js
│   ├── styles.js
│   ├── svgcompress.js
│   └── webp.js
│
├── .gitignore
├── gulpfile.js
├── package.json
└── README.md
```


## Краткое описание папок и файлов
* ```src``` - директория с папками и файлами разрабатываемого проекта.
    * ```fonts``` - директория со шрифтами проекта (поддерживаются вложенные папки).
    * ```img``` - директория с изображениями проекта (поддерживаются вложенные папки).
    * ```includes``` - директория с модулями, шаблонами, миксинами.
    * ```js``` - директория со скриптами проекта (поддерживаются вложенные папки).
    * ```json``` - директория с файлами конфигурации, мета данными страниц в формате json.
    * ```libs``` - директория со скриптами и стилями сторонних библиотек, необходимых для проекта.
    * ```pages``` - директория со страницами проекта (поддерживаются вложенные папки).


* ```tasks``` - директория с задачами сборщика gulp.
    * ```clean.js``` - задача gulp удаляет директорию dist с собраным проектом при каждом запуске
    * ```copyFont.js``` - копирует содержимое директории ```./src/fonts/build/``` в директорию ```./dist/fonts/```
    * ```csscopy.js``` - задача gulp переносит файлы стилей сторонних библиотек из директории ```./src/libs/css/``` в директорию ```./dist/css/```
    * ```fonts.js``` - задача gulp конвертирует шрифты формата otf и ttf из директории ```./src/fonts/``` в формат woff и woff2, с последующим переносом их в директорию ```./src/fonts/build/```
    * ```fontStyle.js``` - задача gulp добавляет записи о шрифтах из директории ```./src/fonts/build/``` в файл ```./src/includes/core/styl/fonts.styl``` (записи требуют небольшой корректировки вручную для корректоного подключения)
    * ```html.js``` - задача gulp для обработки страниц проекта, написанных на html (отрабатывает в режимах ```npm run html```, ```npm run htmlbuild```, ```npm run htmlprod```)
    * ```imgcompress.js``` - задача gulp для обработки и сжатия изображений форматоа jpg и png (отрабатывает в режимах итоговой сборки проекта ```npm run build```, ```npm run prod```, ```npm run htmlbuild```, ```npm run htmlprod```)
    * ```imgcopy.js``` - задача gulp для копирования изображений из директории ```./src/img/``` в директорию ```./dist/img/``` без зжатия (отрабатывает в режиме разработки проекта ```npm start``` и ```npm run html```)
    * ```jscopy.js``` - задача gulp для копирования js файлов сторонних библиотек из директории ```./src/libs/js/``` в директорию ```./dist/js/```
    * ```otf2ttf.js``` - задача gulp для конвертации шрифтов формата otf в формат ttf (сконвертированый файл записывается в директорию ```./src/fonts/``` для последующей обработки задачей ```fonts.js```)
    * ```pug2html.js``` - задача gulp для обработки и конвертации файлов pug в html
    * ```renamePath.js``` - задача gulp для переименования пути к файлам js и css в итоговых html файлах. Например, путь у файлу ```./main.css``` будет переименован в ```./main.min.css```  (отрабатывает в режимах ```npm run prod```, ```npm run htmlprod```)
    * ```script.js``` - задача gulp для обработки js файлов и сниппетов
    * ```server.js``` - задача gulp для активации ```watch``` задач и активации локального сервера
    * ```styles.js``` - задача gulp для обработки и конвертации файлов stylus в css
    * ```svgcompress.js``` - задача gulp для обработки и сжатия svg изображений
    * ```webp.js``` - задача gulp для конвертации изображений формата ```jpg``` и ```png``` в формат webp
* ```.gitignore``` - файл с исключениями для git
* ```gulpfile.js``` - подключение и вызов задач gulp
* ```package.json``` - файл конфигурации gulp